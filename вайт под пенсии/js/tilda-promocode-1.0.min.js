function t_input_promocode_dict(msg){var dict=[];dict.publish={EN:"Please, publish the page, to test promo code activation functionality",RU:"Пожалуйста, опубликуйте страницу, чтобы проверить функциональность активации промокода",FR:"S'il vous plaît, publier la page, pour tester la fonctionnalité d'activation promo de code",DE:"Bitte veröffentlichen Sie die Seite, um Testgutscheincode Aktivierung Funktionalität",ES:"Por favor, publicar la página, a la funcionalidad de activación código promocional prueba",PT:"Por favor, publicar a página, a funcionalidade de ativação código de teste promo",UK:"Будь ласка, опублікуйте сторінку, щоб перевірити функціональність активації промокоду",JA:"、テスト用プロモーションコードのアクティベーション機能に、ページを公開してください。",ZH:"请发布页面，测试促销代码激活功能",PL:"Opublikuj stronę, aby przetestować funkcjonalność aktywacji kodu promocyjnego",KK:"Промокодты іске қосу функциясын тексеру үшін бетті жариялаңыз",IT:"Si prega, pubblicare la pagina, alla funzionalità il codice di attivazione di prova promozionale`",LV:"Lūdzu, publicējiet lapu, lai testa promo kodu aktivizācijas funkcionalitāti"},dict.badprojectid={EN:"Promo code activation error. Bad projectid",RU:"Ошибка активации промокода. Некорректный projectid",FR:"Promo Erreur d'activation de code. Bad projectId",DE:"Promo Code Aktivierungsfehler. Bad projectid",ES:"Error de activación de código promocional. Mala projectId",PT:"Promo erro de ativação código. Bad projectId",UK:"Помилка активації промокоду. Поганий projectid",JA:"プロモーションコードのアクティブ化エラー。悪い projectid",ZH:"促销代码激活错误。坏专案编号",PL:"Błąd aktywacji kodu promocyjnego. Bad projectid",KK:"Промокодты белсендіру қатесі. Нашар projectid",IT:"Errore di attivazione codice promozionale. Bad projectid",LV:"Promo kods aktivizācijas kļūda. Bad projectid"},dict.promocode={EN:"Promo code",RU:"Промокод",FR:"Code promo",DE:"Gutscheincode",ES:"Código promocional",PT:"Código promocional",UK:"Промокод",JA:"プロモーションコード",ZH:"促销代码",PL:"Kod rabatowy",KK:"Промокод",IT:"Codice promozionale",LV:"Promo kods"},dict.activated={EN:"has been activated",RU:"активирован",FR:"a été activé",DE:"wurde aktiviert",ES:"Ha sido activado",PT:"Foi ativado",UK:"активований",JA:"活性化されています",ZH:"已被激活",PL:"został aktywowany",KK:"болды белсендірілді",IT:"è stato attivato",LV:"ir aktivizēta"},dict.discount={EN:"Your discount",RU:"Ваша скидка",FR:"votre remise",DE:"Ihr Rabatt",ES:"su descuento",PT:"seu desconto",UK:"Ваша знижка",JA:"あなたの割引",ZH:"您的折扣",PL:"Twój rabat",KK:"Сіздің жеңілдік",IT:"Lo sconto",LV:"Jūsu atlaide"};var lang=window.browserLang;return void 0!==dict[msg]?void 0!==dict[msg][lang]&&""!=dict[msg][lang]?dict[msg][lang]:dict[msg].EN:"Text not found #"+msg}function t_input_promocode_init(recid,lid){var qel=$("#rec"+recid).find('[data-input-lid="'+lid+'"]');qel.find(".t-inputpromocode").attr("autocomplete",navigator.userAgent.search(/Chrome/)>0?"no":"off"),qel.find(".t-inputpromocode").focusin((function(){qel.find(".t-inputpromocode__btn").css("display","table-cell")})),qel.find(".t-inputpromocode__btn").click((function(){var val=qel.find(".t-inputpromocode").val();if(void 0!==val&&""!=val){console.log("Promo code: "+val);var d={};if(d.promocode=val,d.projectid=$("#allrecords").attr("data-tilda-project-id"),void 0!==d.projectid&&""!=d.projectid){var curMode=$(".t-records").attr("data-tilda-mode");if("edit"!=curMode&&"preview"!=curMode){if(void 0===window.t_promocode_load||"y"!=window.t_promocode_load){window.t_promocode_load="y";var elbtnpc=$(this);elbtnpc.addClass("t-btn_sending"),$.ajax({type:"POST",url:"https://forms.tildacdn.com/payment/promocode/",data:d,dataType:"text",success:function(data){if(delete window.t_promocode_load,elbtnpc.removeClass("t-btn_sending"),""!=data){var obj=JSON.parse(data);if("object"==typeof obj)if(void 0!==obj.message&&"OK"==obj.message){var str="";if(str+='<div style="font-weight:600;" class="t-text">'+t_input_promocode_dict("promocode")+" ",str+=obj.promocode,str+=" "+t_input_promocode_dict("activated")+".<br>"+t_input_promocode_dict("discount")+": ",void 0!==obj.discountsum&&obj.discountsum>0)if("object"==typeof window.tcart)try{"function"==typeof tcart__showPrice&&(str+=tcart__showPrice(obj.discountsum))}catch(err){}else str+=obj.discountsum;void 0!==obj.discountpercent&&obj.discountpercent>0&&(str+=parseFloat(obj.discountpercent)+"%"),str+="</div>",qel.find(".t-inputpromocode__wrapper").html(str);try{t_onFuncLoad("tcart__addPromocode",(function(){tcart__addPromocode(obj)}))}catch(err){}}else void 0!==obj.error&&""!=obj.error?alert(obj.error):alert("Promo code activation some error.");else alert("Promo code activation error. Bad answer from server")}else alert("Promo code activation error. Empty answer from server")},error:function(){delete window.t_promocode_load,elbtnpc.removeClass("t-btn_sending"),alert("Request timeout error (activate promo code)")},timeout:2e4})}}else alert(t_input_promocode_dict("publish"))}else alert(t_input_promocode_dict("badprojectid"))}else console.log("Promo code is empty")}))}